# Core configuration
API_TYPE=responses
STORAGE_TYPE=session

# OpenAI configuration
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_BASE_URL=https://api.openai.com/v1

# Chat Completions defaults
OPENAI_MODEL=gpt-4o-mini
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=1000
OPENAI_TOP_P=1.0
OPENAI_FREQUENCY_PENALTY=0.0
OPENAI_PRESENCE_PENALTY=0.0

# Responses API configuration
RESPONSES_MODEL=gpt-4o-mini
RESPONSES_TEMPERATURE=0.7
RESPONSES_MAX_OUTPUT_TOKENS=1024
RESPONSES_TOP_P=1.0
# Leave the next two unset; Responses API does not support frequency/presence penalties
# RESPONSES_FREQUENCY_PENALTY=0.0
# RESPONSES_PRESENCE_PENALTY=0.0
# Optional: reference a saved prompt created in your account
# RESPONSES_PROMPT_ID=pmpt_xxx
# RESPONSES_PROMPT_VERSION=1
# Optional: configure response format for structured outputs (JSON schema guardrails)
# RESPONSES_RESPONSE_FORMAT={"type":"json_schema","json_schema":{"name":"example","schema":{"type":"object","properties":{"field":{"type":"string"}},"required":["field"]}}}

# File upload configuration
ENABLE_FILE_UPLOAD=false
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=txt,pdf,doc,docx,jpg,png

# Storage configuration
STORAGE_PATH=/tmp/chatbot_conversations

# Chat configuration
CHAT_MAX_MESSAGES=50
CHAT_SESSION_TIMEOUT=3600
CHAT_RATE_LIMIT=60
CHAT_RATE_WINDOW=60
CHAT_ENABLE_LOGGING=true

# Security configuration
CORS_ORIGINS=*
VALIDATE_REFERER=false
API_KEY_VALIDATION=true
SANITIZE_INPUT=true
MAX_MESSAGE_LENGTH=4000

# WebSocket configuration (optional)
WEBSOCKET_ENABLED=false
WEBSOCKET_HOST=0.0.0.0
WEBSOCKET_PORT=8080
WEBSOCKET_SSL=false
WEBSOCKET_SSL_CERT=
WEBSOCKET_SSL_KEY=

# Logging configuration
LOG_LEVEL=info
LOG_FILE=php://stderr
LOG_FORMAT=json
LOG_MAX_SIZE=10485760
LOG_MAX_FILES=5

# Observability Configuration
OBSERVABILITY_ENABLED=true

# Tracing Configuration
TRACING_ENABLED=true
TRACING_EXPORT=false
TRACING_SAMPLE_RATE=1.0

# Metrics Configuration
METRICS_ENABLED=true
METRICS_STORAGE_PATH=/tmp/chatbot_metrics

# Performance configuration
CACHE_ENABLED=false
CACHE_TTL=3600
COMPRESSION_ENABLED=true

# Development configuration
DEBUG=false

# Admin API configuration
ADMIN_ENABLED=true
# DEFAULT_ADMIN_EMAIL=ci-admin@example.com
# DEFAULT_ADMIN_PASSWORD=rotatemeimmediately
# Optional automation defaults for ephemeral installs. Inject via your secret manager and rotate/remove after bootstrap.

# Database Configuration
# For SQLite (default):
DATABASE_PATH=./data/chatbot.db
DATABASE_URL=

# For MySQL (uncomment and configure):
# DATABASE_URL=mysql:host=mysql;port=3306;dbname=chatbot;charset=utf8mb4
# DB_HOST=mysql
# DB_PORT=3306
# DB_NAME=chatbot
# DB_USER=chatbot
# DB_PASSWORD=chatbot
# MYSQL_ROOT_PASSWORD=rootpassword

# Admin API Rate Limiting (Phase 4)
ADMIN_RATE_LIMIT_REQUESTS=300
ADMIN_RATE_LIMIT_WINDOW=60

# Background Jobs (Phase 3)
JOBS_ENABLED=true

# Channels Configuration (WhatsApp via Z-API)
CHANNELS_WHATSAPP_ENABLED=false
ZAPI_BASE_URL=https://api.z-api.io
ZAPI_TIMEOUT_MS=30000
ZAPI_RETRIES=3
WHATSAPP_REPLY_CHUNK_SIZE=4000
WHATSAPP_ALLOW_MEDIA=true
WHATSAPP_MAX_MEDIA_SIZE=10485760

# Auditing Configuration
AUDIT_ENABLED=true
AUDIT_ENCRYPT=true
AUDIT_ENC_KEY=your_random_encryption_key_here_min_32_chars
AUDIT_RETENTION_DAYS=90
AUDIT_PII_PATTERNS=
AUDIT_SAMPLE_RATE=1.0
AUDIT_EVAL_ASYNC=false

# LeadSense - Commercial Opportunity Detection
LEADSENSE_ENABLED=false
LEADSENSE_INTENT_THRESHOLD=0.6
LEADSENSE_SCORE_THRESHOLD=70
LEADSENSE_FOLLOWUP_ENABLED=true
LEADSENSE_PII_REDACTION=true

# LeadSense Notifications
LEADSENSE_SLACK_WEBHOOK=
LEADSENSE_WEBHOOK_URL=
LEADSENSE_WEBHOOK_SECRET=

# Webhook Gateway Security (SPEC_WEBHOOK.md ยง6)
# HMAC signature secret for webhook authentication
WEBHOOK_GATEWAY_SECRET=
# Timestamp tolerance in seconds (anti-replay protection)
WEBHOOK_GATEWAY_TOLERANCE=300
# Enable payload logging for debugging (disable in production)
WEBHOOK_GATEWAY_LOG_PAYLOADS=false
# OpenAI webhook signing secret
OPENAI_WEBHOOK_SIGNING_SECRET=
# IP whitelist for webhook access control (comma-separated IPs or CIDR ranges)
# Examples: 192.168.1.1,10.0.0.0/8,172.16.0.0/12
# Leave empty to disable IP whitelist
WEBHOOK_IP_WHITELIST=

# LeadSense Storage & Security
LEADSENSE_ENCRYPTION=false
LEADSENSE_ENC_KEY=

# LeadSense Advanced Settings
LEADSENSE_MAX_TOKENS=1000
LEADSENSE_MAX_FIELDS=20
LEADSENSE_CONTEXT_WINDOW=10
LEADSENSE_SCORING_MODE=rules
LEADSENSE_DEBOUNCE_WINDOW=300
LEADSENSE_MAX_DAILY_NOTIFICATIONS=100

# Billing & Metering Configuration
# Asaas Payment Gateway (https://docs.asaas.com/)
ASAAS_ENABLED=false
ASAAS_API_KEY=your_asaas_api_key_here
ASAAS_PRODUCTION=false
# Set to true for production environment, false for sandbox

# Quota & Usage Tracking
USAGE_TRACKING_ENABLED=true
QUOTA_ENFORCEMENT_ENABLED=true
QUOTA_WARNING_THRESHOLD=80
# Percentage at which to send quota warning notifications

# Multi-Tenant Rate Limiting
# Set to true to require tenant ID or API key for all chat requests (strict mode)
# Set to false to allow anonymous requests with IP-based rate limiting fallback (permissive mode)
USAGE_TRACKING_REQUIRE_TENANT_ID=false

# Billing Notifications
BILLING_NOTIFICATIONS_ENABLED=true
BILLING_ADMIN_EMAIL=billing@example.com
# Email for billing-related notifications

# Auto-Billing Configuration
AUTO_INVOICE_GENERATION=false
AUTO_PAYMENT_RETRY=true
PAYMENT_RETRY_ATTEMPTS=3
PAYMENT_RETRY_INTERVAL_HOURS=24

# Multi-Tenant Backup Configuration
# Backup frequency based on highest tenant tier (hourly|6hourly|daily|weekly)
BACKUP_FREQUENCY=hourly
# Enable per-tenant backup isolation (creates separate backup files per tenant)
BACKUP_TENANT_ISOLATION=false
# Adjust retention policies based on tenant tier
BACKUP_TIER_AWARE=true

# Retention by tenant tier (in days)
BACKUP_RETENTION_ENTERPRISE=30
BACKUP_RETENTION_PRO=14
BACKUP_RETENTION_STARTER=7
BACKUP_RETENTION_FREE=3
