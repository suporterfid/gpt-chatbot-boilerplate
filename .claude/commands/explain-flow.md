Explain the complete flow of a chat request through the system:
1. Frontend initiation (chatbot-enhanced.js)
2. API endpoint handling (chat-unified.php)
3. Service layer processing (ChatHandler, AgentService, etc.)
4. OpenAI API interaction
5. Response streaming (SSE/WebSocket)
6. Database persistence
7. Audit logging

Include key files and line numbers for each step.
